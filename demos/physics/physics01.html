<!DOCTYPE html>
<html lang="en"></html>
<head>
  <meta charset="UTF-8">
  <title>Threejs Cannonjs Sample</title>
  <link rel="stylesheet" href="../css/marx.min.css">
  <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <div class="menu-bg"></div>
  <div class="nav">
    <div class="menu-icon"></div>
    <ul>
      <li><a href="./index.html">HOME</a></li>
      <li><a href="./cube/cube01.html">cube01</a></li>
      <li><a href="./cube/cube02.html">cube02</a></li>
      <li><a href="./cube/cube03.html">cube03</a></li>
      <li><a href="./line/line01.html">line01</a></li>
      <li><a href="./line/line02.html">line02</a></li>
      <li><a href="./line/line03.html">line03</a></li>
      <li><a href="./line/line04.html">line04</a></li>
      <li><a href="./circle/circle01.html">circle01</a></li>
      <li><a href="./circle/circle02.html">circle02</a></li>
      <li><a href="./plane/plane01.html">plane01</a></li>
      <li><a href="./plane/plane02.html">plane02</a></li>
      <li><a href="./plane/plane03.html">plane03</a></li>
      <li><a href="./particle/particle01.html">particle01</a></li>
      <li><a href="./uniqe/uniqe01.html">uniqe01</a></li>
      <li><a href="./uniqe/uniqe02.html">uniqe02</a></li>
      <li><a href="./uniqe/uniqe03.html">uniqe03</a></li>
      <li><a href="./physics/physics01.html">physics01</a></li>
      <li><a href="./physics/physics02.html">physics02</a></li>
      <li><a href="./other/other01.html">other01</a></li>
      <li><a href="./other/other02.html">other02</a></li>
      <li><a href="./helper/helper01.html">helper01</a></li>
      <li><a href="./demo/circle2d-animation.html">DEMO: circle2d-animation</a></li>
      <li><a href="./demo/buffer-geometry.html">DEMO: buffer-geometry</a></li>
    </ul>
  </div>
  <div class="l-wrapper">
    <h1>cannon.js</h1>
    <div class="nav">
      <div class="menu-icon"></div>
      <ul>
        <li><a href="../index.html">HOME</a></li>
        <li><a href="../cube/cube01.html">cube01</a></li>
        <li><a href="../cube/cube02.html">cube02</a></li>
        <li><a href="../cube/cube03.html">cube03</a></li>
        <li><a href="../line/line01.html">line01</a></li>
        <li><a href="../line/line02.html">line02</a></li>
        <li><a href="../line/line03.html">line03</a></li>
        <li><a href="../line/line04.html">line04</a></li>
        <li><a href="../circle/circle01.html">circle01</a></li>
        <li><a href="../circle/circle02.html">circle02</a></li>
        <li><a href="../plane/plane01.html">plane01</a></li>
        <li><a href="../plane/plane02.html">plane02</a></li>
        <li><a href="../plane/plane03.html">plane03</a></li>
        <li><a href="../particle/particle01.html">particle01</a></li>
        <li><a href="../uniqe/uniqe01.html">uniqe01</a></li>
        <li><a href="../uniqe/uniqe02.html">uniqe02</a></li>
        <li><a href="../uniqe/uniqe03.html">uniqe03</a></li>
        <li><a href="../physics/physics01.html">physics01</a></li>
        <li><a href="../physics/physics02.html">physics02</a></li>
        <li><a href="../other/other01.html">other01</a></li>
        <li><a href="../other/other02.html">other02</a></li>
        <li><a href="../helper/helper01.html">helper01</a></li>
        <li><a href="../demo/circle2d-animation.html">DEMO: circle2d-animation</a></li>
        <li><a href="../demo/buffer-geometry.html">DEMO: buffer-geometry</a></li>
      </ul>
    </div><h2 id="-sample">使い方 Sample</h2>
<h3 id="-">初期設定</h3>
<h4 id="cannon-js-">CANNON.jsの世界を生成</h4>
<pre><code>world = new CANNON.World();
</code></pre><h4 id="-">重力の設定</h4>
<pre><code>world.gravity.set(0,0,0);// 重力
world.broadphase = new CANNON.NaiveBroadphase();// 衝突している可能性のある剛体を見つける
world.solver.iterations = 10;// 反復計算回数
</code></pre><blockquote>
<p><strong>剛体</strong><br>剛体はどんな力を受けても形や体積を変えない。剛体の運動は，重心に全質量が集中した仮想的質点が行う重心運動と，重心のまわりの回転運動とに分離して論じることができる。<br><a href="https://kotobank.jp/word/%E5%89%9B%E4%BD%93-62662">コトバンク &gt; 剛体とは</a></p>
</blockquote>

    <script src="../src/three.min.js"></script>
    <script src="../src/ConvexGeometry.js"></script>
    <script src="../src/CanvasRenderer.js"></script>
    <script src="../src/Projector.js"></script>
    <script src="../src/cannon.min.js"></script>
    <script src="../src/jquery.min.js"></script>
    <script src="../src/common.js"></script>
    <script>
      var world, mass, body, shape, timeStep=1/60,
         camera, scene, renderer, geometry, material, mesh;
      initThree();
      initCannon();
      animate();
      function initCannon() {
          // CANNON.jsの世界を生成
          world = new CANNON.World();
      
          world.gravity.set(0,0,0);// 重力の設定
          world.broadphase = new CANNON.NaiveBroadphase();// 衝突している可能性のある物体を見つける
          world.solver.iterations = 10;// 反復計算回数
      
          // 対象となる剛体の生成
          shape = new CANNON.Box(new CANNON.Vec3(1,1,1));
          mass = 1;
          body = new CANNON.Body({
            mass: 1
          });
          body.addShape(shape);
          body.angularVelocity.set(0,10,0);
          body.angularDamping = 0.5;
          world.addBody(body);
      }
      function initThree() {
          scene = new THREE.Scene();
          camera = new THREE.PerspectiveCamera( 75, document.body.clientWidth / window.innerHeight, 1, 100 );
          camera.position.z = 5;
          scene.add( camera );
          geometry = new THREE.BoxGeometry( 1, 1, 1 );
          material = new THREE.MeshBasicMaterial( { color: 0xff0000, wireframe: true } );
          mesh = new THREE.Mesh( geometry, material );
          scene.add( mesh );
          renderer = new THREE.WebGLRenderer();
          renderer.setSize( document.body.clientWidth, window.innerHeight );
          document.body.appendChild( renderer.domElement );
      }
      function animate() {
          requestAnimationFrame( animate );
          updatePhysics();
          render();
      }
      function updatePhysics() {
          // Step the physics world
          world.step(timeStep);
          // Copy coordinates from Cannon.js to Three.js
          mesh.position.copy(body.position);
          mesh.quaternion.copy(body.quaternion);
      }
      function render() {
          renderer.render( scene, camera );
      }
    </script>
  </div>
</body>